function sendAjaxRequest(a){$.ajax({async:true,timeout:3000,type:"post",url:a["url"],dataType:"json",contentType:"application/json",beforeSend:function(){a["before"]()},success:function(b){a["success"](b)},complete:function(){a["complete"]()},error:function(b,d,c){a["error"]()}})}function ajaxSubmitProfile(c){var d="",f="",h=false;var b=$(c.target).closest("#profile-form");$.each(b.find("input"),function(o,j){var l=$(j).attr("type");var m=$(j).val();if(l=="tel"&&!m.match(/^0?1[3|4|5|8][0-9]\d{8}$/)){alert("请输入正确的手机号码");h=true;return false}if(l=="tel"||l=="text"||l=="number"){if($(j).val().length===0){alert("请填写完整");h=true;return false}var k=d?"&":"?";k=k+$(j).attr("name")+"="+$(j).val();d=d+k}});if(h){return false}$.each(b.find("option:selected"),function(k,j){if(f.length){f=f+":"+$(j).val()}else{f=f+$(j).val()}});if(f.length){d=d+"&follower="+f}var g={url:"/ajaxSetProfile"+d,before:showLoader,success:e,complete:a,error:i};sendAjaxRequest(g);function e(j){var k="";if(j.response===1){k="<p>设置失败，请稍后再试!</p>"}else{if(j.response===0){k="<p>设置成功!</p>"}}$(".profile-mesg").html(k)}function a(){$(".profile-mesg").show();hideLoader()}function i(){$(".profile-mesg").html("<p>链接失败，请稍后再试!</p>")}}function triggerAlarm(){var b=$("#alarmValue").hasClass("ui-checkbox-on")?"off":"on";var d={url:"/ajaxSetAlarm?value="+b,before:showLoader,success:e,complete:a,error:c};sendAjaxRequest(d);function e(f){var g="";if(f.response===1){g="<p>设置失败，请稍后再试!</p>"}else{if(f.response===0){g="<p>设置成功!</p>"}}$(".profile-mesg").html(g)}function a(){$(".profile-mesg").show();hideLoader()}function c(){$(".profile-mesg").html("<p>链接失败，请稍后再试!</p>")}}function ajaxChangePWD(b){if($('input[name="new-pwd"]').val()!=$('input[name="confirm-pwd"]').val()){alert("两次输入新密码不一样");return false}var i=false;$.each($('input[type="password"]'),function(m,j){var l=$(j).val();if(l.length<6){alert("长度不小于6位");i=true;return false}var k=new RegExp("[a-zA-Z]");if(!k.test(l)){alert("至少包含一个字母");i=true;return false}k=new RegExp("[0-9]");if(!k.test(l)){alert("至少包含一个数字");i=true;return false}k=new RegExp("[/#?@]");if(k.test(l)){alert("不能包含/#?@符号");i=true;return false}});if(i){return false}var f=$.md5($('input[name="old-pwd"]').val());var a=$.md5($('input[name="new-pwd"]').val());var c="?old="+f+"&new="+a;var g={url:"/ajaxChangePWD"+c,before:showLoader,success:e,complete:d,error:h};sendAjaxRequest(g);function e(j){var k="";if(j.response===1){k="<p>修改失败，稍后再试!</p>"}else{if(j.response===0){k="<p>修改成功!</p>"}else{if(j.response===2){k="<p>原始密码错误</p>"}}}$(".change-box").html(k)}function d(){$(".change-box").show();hideLoader()}function h(){$(".change-box").html("<p>链接失败，稍后再试!</p>")}}function showLoader(){$.mobile.loading("show",{text:"数据加载中，请稍候",textVisible:true,dataType:"json",theme:"a",textonly:false,html:""})}function hideLoader(){$.mobile.loading("hide")};
