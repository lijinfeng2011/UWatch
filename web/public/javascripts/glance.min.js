(function(c){var d=null;c(document).on("pagebeforeshow","#pageHomepage",function(){window.history.replaceState(null,null,"/")});c(document).on("pagebeforeshow","#pageSubscribe",function(){window.history.replaceState(null,null,"/")});c(document).on("pagebeforeshow","#pageGlance",function(){window.history.replaceState(null,null,"/");c(".message-link").unbind("click").bind("click",a);d=setTimeout(b,10000)});c(document).on("pagebeforeshow","#mesgDetail",function(){window.history.replaceState(null,null,"/")});c(document).on("pagebeforeshow","#pageLogin",function(){window.history.replaceState(null,null,"/")});c(document).on("pagebeforeshow","#profile",function(){window.history.replaceState(null,null,"/")});c(document).on("pagebeforehide","#pageGlance",function(){clearTimeout(d)});function a(f){var e=c(f.target).closest("li").find(".status-icon");e.removeClass("ui-icon-alert").removeClass("ui-icon-info").addClass("ui-icon-check")}function b(){c.ajax({timeout:3000,async:true,dataType:"json",url:"/ajaxGetMessageGroup",success:function(e){c(".ui-icon-check").closest("li").remove();c(".status-icon").removeClass("ui-icon-alert").addClass("ui-icon-info");if(e.mesgGrp!=null&&e.mesgGrp.length>0){c.each(e.mesgGrp,function(j,g){var h=c('li[name="'+g.name+'"]');h.length&&h.remove();var i='<li name="'+g.name+'"><a href="/mesgDetail?id='+g.name+'" class="message-link" data-transition="flip">'+g.name+'</a><a href="#" class="status-icon" data-icon="alert"></a></li>';c("#mainList").prepend(i).listview("refresh")});c(".message-link").unbind("click").bind("click",a);c(".mesg-box").hide()}else{var f="<p>没有报警信息!</p>";c(".mesg-box").html(f).show()}},error:function(e,h,f){var g="<p>网络连接失效，无法获取最新信息!</p>";c(".mesg-box").html(g).show()},complete:function(){d=setTimeout(b,20000)},})}})(jQuery);
